#!/bin/bash
# Runs Drake without Nailgun (needs an uberjar)
DRAKE_HOME=$(dirname $(dirname $0))
DRAKE_JAR=$DRAKE_HOME/target/drake.jar

if [[ ! -f $DRAKE_JAR ]]; then
  echo "========= UBERJAR COMPILING ========="
  cd $DRAKE_HOME
  lein uberjar
  cd -
  echo "========= UBERJAR COMPILED ========="
fi

HADOOP_CLASSPATH=`hadoop classpath`

if [[ `which drip` ]]; then
  drip -cp ${HADOOP_CLASSPATH}:${DRAKE_JAR} drake.core "$@"
else
  java -cp ${HADOOP_CLASSPATH}:${DRAKE_JAR} drake.core "$@"
fi
