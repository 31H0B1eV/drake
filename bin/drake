#!/bin/bash
# Runs Drake without Nailgun (needs an uberjar)
DRAKE_HOME=$(dirname $(dirname $0))
DRAKE_JAR=$DRAKE_HOME/target/drake.jar

if [[ ! -f $DRAKE_JAR ]]; then
  echo "========= UBERJAR COMPILING ========="
  cd $DRAKE_HOME
  lein uberjar
  echo "========= UBERJAR COMPILED ========="
fi

HADOOP_CONF=${HADOOP_HOME:=/etc/hadoop}/conf

if [[ `which drip` ]]; then
  drip -cp ${HADOOP_CONF}:${DRAKE_JAR} drake.core "$@"
else
  java -cp ${HADOOP_CONF}:${DRAKE_JAR} drake.core "$@"
fi
